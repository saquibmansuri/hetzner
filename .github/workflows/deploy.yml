name: Deploy VM for New Client
env: 
    HCLOUD_TOKEN_PASS: ${{ secrets.HCLOUD_TOKEN }}

on:
  workflow_dispatch:
    inputs:
      client_name:
        description: 'Name of the new client'
        required: true
      desired_server_location:
        description: 'Desired location of server (e.g., nbg1, fsn1, hel1, ash, hil --Default is nbg1 )' 
        required: true
        default: 'nbg1'
      server_type:
        description: 'Type of shared cpu server (e.g., CX11, CPX11, CX21, CX31, CX51)'
        required: true
      os_image:
        description: 'Operating system image (e.g., ubuntu-20.04, fedora, debin, centos)'
        required: true
        default: 'ubuntu-latest'

jobs:
  deploy-vm:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Install hcloud CLI
        run: |
         sudo apt-get update -y
         sudo apt-get install hcloud-cli -y
         hcloud version

      - name: Create Hetzner Cloud VM
        run: |
          export HCLOUD_TOKEN="$HCLOUD_TOKEN_PASS"
          echo "Server Creating"
          hcloud server create --name ${{ github.event.inputs.client_name }}-vm \
                                --location ${{ github.event.inputs.desired_server_location }} \
                                --type ${{ github.event.inputs.server_type }} \
                                --image ${{ github.event.inputs.os_image }} \
                                --ssh-key ${{ secrets.TEST_SSH_KEY }} \